{% assign post = include.post %}

{% if post.author %}
  {% if post.author.name %}
    {% assign author_name = post.author.name %}
  {% else %}
    {% assign author_name = post.author %}
  {% endif %}
{% endif %}

{% capture date %}<span class="date">{{ post.date | date: "%B %d, %Y" }}</span>{% endcapture %}

<div class="metadata">
  <p>
    <i>by</i>
    {% if post.type == "post" %}
      <a class="author" href="{{ post.url }}#about-the-author">{{ author_name }}</a>
    {% else %}
      <span class="author">{{ author_name }}</span>
    {% endif %}
    {% if post.x-post and post.type == "newsletter" %}
      · {{ date }} · <i>originally sent to</i> <a href="{{ post.x-post }}">public-testtwf@w3.org</a>.
    {% else if post.x-post %}
      {% capture url %}{{ post.url }}{% endcapture %}
      {% capture url %}{{ url | replace_first: "http://www.", "" }}{% endcapture %}
      {% capture url %}{{ url | replace_first: "https://www.", "" }}{% endcapture %}
      {% capture url %}{{ url | replace_first: "http://", "" }}{% endcapture %}
      {% capture url %}{{ url | replace_first: "https://", "" }}{% endcapture %}
      {% capture url %}{{ url | truncate: 30 }}{% endcapture %}
      · {{ date }} · <i>originally posted on</i> <a href="{{ post.url }}" title="{{ post.url }}">{{ url }}</a>.
    {% else %}
      · {{ date }}.
    {% endif %}
  </p>
</div>